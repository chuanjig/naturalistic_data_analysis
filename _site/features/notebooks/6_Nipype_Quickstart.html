<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,minimum-scale=1">

  <title>Preprocessing with Nipype Quickstart</title>
  <meta name="description" content="        Preprocessing with Nipype Quickstart    Nipype Quickstart Written by Michael NotterHere we will provide a quick introduction to some of the concepts ...">

  <link rel="canonical" href="http://dartbrains.org//features/notebooks/6_Nipype_Quickstart.html">
  <link rel="alternate" type="application/rss+xml" title="DartBrains" href="http://dartbrains.org//feed.xml">

  <meta property="og:url"         content="http://dartbrains.org//features/notebooks/6_Nipype_Quickstart.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Preprocessing with Nipype Quickstart" />
<meta property="og:description" content="        Preprocessing with Nipype Quickstart    Nipype Quickstart Written by Michael NotterHere we will provide a quick introduction to some of the concepts ..." />
<meta property="og:image"       content="http://dartbrains.org/images/logo/dartbrains_logo_square_transparent.png" />

<meta name="twitter:card" content="summary">


  <script type="application/ld+json">
  {
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "http://dartbrains.org//features/notebooks/6_Nipype_Quickstart.html",
  "headline": "Preprocessing with Nipype Quickstart",
  "datePublished": "2019-12-27T11:24:15-08:00",
  "dateModified": "2019-12-27T11:24:15-08:00",
  "description": "        Preprocessing with Nipype Quickstart    Nipype Quickstart Written by Michael NotterHere we will provide a quick introduction to some of the concepts ...",
  "author": {
    "@type": "Person",
    "name": "Luke Chang"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Data 100 at UC Berkeley",
    "logo": {
      "@type": "ImageObject",
      "url": "http://dartbrains.org/",
      "width": 60,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "http://dartbrains.org/",
    "height": 60,
    "width": 60
  }
}

  </script>
  <link rel="stylesheet" href="/assets/css/styles.css">

  <!-- <link rel="manifest" href="/manifest.json"> -->
  <!-- <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#efae0a"> -->
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#233947">

  <!-- Favicon -->
  <link rel="shortcut icon" type="image/x-icon" href="/images/logo/favicon.ico">

  <!-- MathJax Config -->
  <!-- Allow inline math using $ and automatically break long math lines -->
<!-- (mostly) copied from nbconvert configuration -->
<!-- https://github.com/jupyter/nbconvert/blob/master/nbconvert/templates/html/mathjax.tpl -->
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
        processEscapes: true,
        processEnvironments: true
    },
    // Center justify equations in code and markdown cells. Elsewhere
    // we use CSS to left justify single line equations in code cells.
    displayAlign: 'center',
    "HTML-CSS": {
        styles: {'.MathJax_Display': {"margin": 0}},
        linebreaks: { automatic: true },
    },
    
});
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS_HTML' async></script>


  <!-- DOM updating function -->
  <script src="/assets/js/page/dom-update.js"></script>

  <!-- Selectors for elements on the page -->
  <script src="/assets/js/page/documentSelectors.js"></script>

  <!-- Define some javascript variables that will be useful in other javascript -->
  <script>
    const site_basename = '/';
  </script>

  <!-- Add AnchorJS to let headers be linked -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js" async></script>
  <script src="/assets/js/page/anchors.js" async></script>

  <!-- Include Turbolinks to make page loads fast -->
  <!-- https://github.com/turbolinks/turbolinks -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/turbolinks/5.2.0/turbolinks.js" async></script>
  <meta name="turbolinks-cache-control" content="no-cache">

  <!-- Load nbinteract for widgets -->
  

  <!-- Load Thebelab for interactive widgets -->
  <!-- Include Thebelab for interactive code if it's enabled -->



  <!-- Load the auto-generating TOC (non-async otherwise the TOC won't load w/ turbolinks) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.8.1/tocbot.min.js" async></script>
  <script src="/assets/js/page/tocbot.js"></script>

  <!-- Google analytics -->
  
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-138270939-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-138270939-1');
</script>



  <!-- Clipboard copy button -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" async></script>

  <!-- Load custom website scripts -->
  <script src="/assets/js/scripts.js" async></script>

  <!-- Load custom user CSS and JS  -->
  <script src="/assets/custom/custom.js" async></script>
  <link rel="stylesheet" href="/assets/custom/custom.css">

  <!-- Update interact links w/ REST param, is defined in includes so we can use templates -->
  
<script>
/**
  * To auto-embed hub URLs in interact links if given in a RESTful fashion
 */

function getJsonFromUrl(url) {
  var query = url.split('?');
  if (query.length < 2) {
    // No queries so just return false
    return false;
  }
  query = query[1];
  // Collect REST params into a dictionary
  var result = {};
  query.split("&").forEach(function(part) {
    var item = part.split("=");
    result[item[0]] = decodeURIComponent(item[1]);
  });
  return result;
}
    
function dict2param(dict) {
    params = Object.keys(dict).map(function(k) {
        return encodeURIComponent(k) + '=' + encodeURIComponent(dict[k])
    });
    return params.join('&')
}

// Parse a Binder URL, converting it to the string needed for JupyterHub
function binder2Jupyterhub(url) {
  newUrl = {};
  parts = url.split('v2/gh/')[1];
  // Grab the base repo information
  repoinfo = parts.split('?')[0];
  var [org, repo, ref] = repoinfo.split('/');
  newUrl['repo'] = ['https://github.com', org, repo].join('/');
  newUrl['branch'] = ref
  // Grab extra parameters passed
  params = getJsonFromUrl(url);
  if (params['filepath'] !== undefined) {
    newUrl['subPath'] = params['filepath']
  }
  return dict2param(newUrl);
}

// Filter out potentially unsafe characters to prevent xss
function safeUrl(url)
{
   return String(encodeURIComponent(url))
            .replace(/&/g, '&amp;')
            .replace(/"/g, '&quot;')
            .replace(/'/g, '&#39;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
}

function addParamToInternalLinks(hub) {
  var links = document.querySelectorAll("a").forEach(function(link) {
    var href = link.href;
    // If the link is an internal link...
    if (href.search("http://dartbrains.org") !== -1 || href.startsWith('/') || href.search("127.0.0.1:") !== -1) {
      // Assume we're an internal link, add the hub param to it
      var params = getJsonFromUrl(href);
      if (params !== false) {
        // We have REST params, so append a new one
        params['jupyterhub'] = hub;
      } else {
        // Create the REST params
        params = {'jupyterhub': hub};
      }
      // Update the link
      var newHref = href.split('?')[0] + '?' + dict2param(params);
      link.setAttribute('href', decodeURIComponent(newHref));
    }
  });
  return false;
}


// Update interact links
function updateInteractLink() {
    // hack to make this work since it expects a ? in the URL
    rest = getJsonFromUrl("?" + location.search.substr(1));
    jupyterHubUrl = rest['jupyterhub'];
    var hubType = null;
    var hubUrl = null;
    if (jupyterHubUrl !== undefined) {
      hubType = 'jupyterhub';
      hubUrl = jupyterHubUrl;
    }

    if (hubType !== null) {
      // Sanitize the hubUrl
      hubUrl = safeUrl(hubUrl);

      // Add HTTP text if omitted
      if (hubUrl.indexOf('http') < 0) {hubUrl = 'http://' + hubUrl;}
      var interactButtons = document.querySelectorAll("button.interact-button")
      var lastButton = interactButtons[interactButtons.length-1];
      var link = lastButton.parentElement;

      // If we've already run this, skip the link updating
      if (link.nextElementSibling !== null) {
        return;
      }

      // Update the link and add context div
      var href = link.getAttribute('href');
      if (lastButton.id === 'interact-button-binder') {
        // If binder links exist, we need to re-work them for jupyterhub
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // If localhost, assume we're working from a local Jupyter server and remove `/hub`
          first = [hubUrl, 'git-sync'].join('/')
        } else {
          first = [hubUrl, 'hub', 'user-redirect', 'git-sync'].join('/')
        }
        href = first + '?' + binder2Jupyterhub(href);
      } else {
        // If interact button isn't binderhub, assume it's jupyterhub
        // If JupyterHub links, we only need to replace the hub url
        href = href.replace("https://jupyterhub.dartmouth.edu", hubUrl);
        if (hubUrl.indexOf('http%3A%2F%2Flocalhost') > -1) {
          // Assume we're working from a local Jupyter server and remove `/hub`
          href = href.replace("/hub/user-redirect", "");
        }
      }
      link.setAttribute('href', decodeURIComponent(href));

      // Add text after interact link saying where we're launching
      hubUrlNoHttp = decodeURIComponent(hubUrl).replace('http://', '').replace('https://', '');
      link.insertAdjacentHTML('afterend', '<div class="interact-context">on ' + hubUrlNoHttp + '</div>');

      // Update internal links so we retain the hub url
      addParamToInternalLinks(hubUrl);
    }
}

runWhenDOMLoaded(updateInteractLink)
document.addEventListener('turbolinks:load', updateInteractLink)
</script>


  <!-- Lunr search code - will only be executed on the /search page -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.6/lunr.min.js" async></script>
  <script>var initQuery = function() {
  // See if we have a search box
  var searchInput = document.querySelector('input#lunr_search');
  if (searchInput === null) {
    return;
  }

  // Function to parse our lunr cache
  var idx = lunr(function () {
    this.field('title')
    this.field('excerpt')
    this.field('categories')
    this.field('tags')
    this.ref('id')

    this.pipeline.remove(lunr.trimmer)

    for (var item in store) {
      this.add({
        title: store[item].title,
        excerpt: store[item].excerpt,
        categories: store[item].categories,
        tags: store[item].tags,
        id: item
      })
    }
  });

  // Run search upon keyup
  searchInput.addEventListener('keyup', function () {
    var resultdiv = document.querySelector('#results');
    var query = document.querySelector("input#lunr_search").value.toLowerCase();
    var result =
      idx.query(function (q) {
        query.split(lunr.tokenizer.separator).forEach(function (term) {
          q.term(term, { boost: 100 })
          if(query.lastIndexOf(" ") != query.length-1){
            q.term(term, {  usePipeline: false, wildcard: lunr.Query.wildcard.TRAILING, boost: 10 })
          }
          if (term != ""){
            q.term(term, {  usePipeline: false, editDistance: 1, boost: 1 })
          }
        })
      });

      // Empty the results div
      while (resultdiv.firstChild) {
        resultdiv.removeChild(resultdiv.firstChild);
      }

    resultdiv.insertAdjacentHTML('afterbegin', '<p class="results__found">'+result.length+' Result(s) found</p>');
    for (var item in result) {
      var ref = result[item].ref;
      if(store[ref].teaser){
        var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<div class="archive__item-teaser">'+
                '<img src="'+store[ref].teaser+'" alt="">'+
              '</div>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      else{
    	  var searchitem =
          '<div class="list__item">'+
            '<article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">'+
              '<h2 class="archive__item-title" itemprop="headline">'+
                '<a href="'+store[ref].url+'" rel="permalink">'+store[ref].title+'</a>'+
              '</h2>'+
              '<p class="archive__item-excerpt" itemprop="description">'+store[ref].excerpt.split(" ").splice(0,20).join(" ")+'...</p>'+
            '</article>'+
          '</div>';
      }
      resultdiv.insertAdjacentHTML('beforeend', searchitem);
    }
  });
};

initFunction(initQuery);
</script>

  <!-- Load JS that depends on site variables -->
  <script src="/assets/js/page/copy-button.js" async></script>

  <!-- Hide cell code -->
  <script src="/assets/js/page/hide-cell.js" async></script>

  <!-- Printing the screen -->
  <!-- Include nbinteract for interactive widgets -->
<script src="https://printjs-4de6.kxcdn.com/print.min.js" async></script>
<script>
printContent = () => {
    // MathJax displays a second version of any math for assistive devices etc.
    // This prevents double-rendering in the PDF output.
    var ignoreAssistList = [];
    assistives = document.querySelectorAll('.MathJax_Display span.MJX_Assistive_MathML').forEach((element, index) => {
        var thisId = 'MathJax-assistive-' + index.toString();
        element.setAttribute('id', thisId);
        ignoreAssistList.push(thisId)
    });

    // Print the actual content object
    printJS({
        printable: 'textbook_content',
        type: 'html',
        css: "/assets/css/styles.css",
        style: "#textbook_content {padding-top: 40px};",
        scanStyles: false,
        targetStyles: ["*"],
        ignoreElements: ignoreAssistList,
        documentTitle: "Made with Jupyter Book"
    })
};

initPrint = () => {
    document.querySelector('#interact-button-print').addEventListener('click', printContent)
}

initFunction(initPrint)
</script>

</head>

  <body>
    <!-- Include the ThebeLab config so it gets reloaded on each page -->
    <script type="text/x-thebe-config">{
    requestKernel: true,
    binderOptions: {
    repo: "ljchang/dartbrains",
    ref: "master",
    },
    codeMirrorConfig: {
    theme: "abcdef",
    mode: "python"
    },
    kernelOptions: {
    kernelName: "python3",
    path: "content/features/notebooks"
    }
}
</script>

    <!-- .js-show-sidebar shows sidebar by default -->
    <div id="js-textbook" class="c-textbook js-show-sidebar">
      



<nav id="js-sidebar" class="c-textbook__sidebar">
  <a href="https://dartbrains.org"><img src="/images/logo/dartbrains_logo_square_transparent.png" class="textbook_logo" id="sidebar-logo" alt="textbook logo" data-turbolinks-permanent/></a>
  <h2 class="c-sidebar__title">DartBrains</h2>
  <ul class="c-sidebar__chapters">
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/intro">
        <a class="c-sidebar__entry"
          href="/intro.html"
        >
          
          Home
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/markdown/Contributing">
        <a class="c-sidebar__entry"
          href="/features/markdown/Contributing.html"
        >
          
          Contributing
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="https://github.com/ljchang/dartbrains">
        <a class="c-sidebar__entry"
          href="https://github.com/ljchang/dartbrains"
        >
          
          GitHub repository
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Course Overview</li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/markdown/Instructors">
        <a class="c-sidebar__entry"
          href="/features/markdown/Instructors.html"
        >
          
          Instructors
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/markdown/Syllabus">
        <a class="c-sidebar__entry"
          href="/features/markdown/Syllabus.html"
        >
          
          Syllabus
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/markdown/Schedule">
        <a class="c-sidebar__entry"
          href="/features/markdown/Schedule.html"
        >
          
          Schedule
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Computing Resources</li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/notebooks/0_Introduction_to_JupyterHub">
        <a class="c-sidebar__entry"
          href="/features/notebooks/0_Introduction_to_JupyterHub.html"
        >
          
          Getting Started with JupyterHub
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/notebooks/1_Introduction_to_Programming">
        <a class="c-sidebar__entry"
          href="/features/notebooks/1_Introduction_to_Programming.html"
        >
          
          Introduction to Python
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/notebooks/2_Introduction_to_Dataframes_Plotting">
        <a class="c-sidebar__entry"
          href="/features/notebooks/2_Introduction_to_Dataframes_Plotting.html"
        >
          
          Introduction to Dataframes and Plotting
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/notebooks/Download_Data">
        <a class="c-sidebar__entry"
          href="/features/notebooks/Download_Data.html"
        >
          
          Download Localizer Data
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/notebooks/Glossary">
        <a class="c-sidebar__entry"
          href="/features/notebooks/Glossary.html"
        >
          
          Glossary of Python Functions
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      
        <li><h2 class="c-sidebar__title">Topics</li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/markdown/Intro_to_Neuroimaging">
        <a class="c-sidebar__entry"
          href="/features/markdown/Intro_to_Neuroimaging.html"
        >
          
            1.
          
          Introduction to Neuroimaging
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/markdown/Signal_Measurement">
        <a class="c-sidebar__entry"
          href="/features/markdown/Signal_Measurement.html"
        >
          
            2.
          
          Measurement and Signal
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/notebooks/3_Introduction_to_NeuroimagingData_in_Python">
        <a class="c-sidebar__entry"
          href="/features/notebooks/3_Introduction_to_NeuroimagingData_in_Python.html"
        >
          
            3.
          
          Introduction to Neuroimaging Data
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/notebooks/5_Signal_Processing">
        <a class="c-sidebar__entry"
          href="/features/notebooks/5_Signal_Processing.html"
        >
          
            4.
          
          Signal Processing Basics
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/markdown/Preprocessing">
        <a class="c-sidebar__entry"
          href="/features/markdown/Preprocessing.html"
        >
          
            5.
          
          Preprocessing
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/features/notebooks/6_Nipype_Quickstart">
              <a class="c-sidebar__entry"
                href="/features/notebooks/6_Nipype_Quickstart.html"
              >
                
                Preprocessing with Nipype Quickstart
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/features/notebooks/7_Nipype_Preprocessing">
              <a class="c-sidebar__entry"
                href="/features/notebooks/7_Nipype_Preprocessing.html"
              >
                
                Building Preprocessing Workflows with Nipype
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/features/notebooks/8_fmriprep_tutorial">
              <a class="c-sidebar__entry"
                href="/features/notebooks/8_fmriprep_tutorial.html"
              >
                
                Introduction to Automated Preprocessing with fmriprep
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/notebooks/9_GLM">
        <a class="c-sidebar__entry"
          href="/features/notebooks/9_GLM.html"
        >
          
            6.
          
          Introduction to the General Linear Model
        </a>
      </li>

      
      

      

      
      

      
        

        

        <ul class="c-sidebar__sections">
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/features/notebooks/10_GLM_Single_Subject_Model">
              <a class="c-sidebar__entry"
                href="/features/notebooks/10_GLM_Single_Subject_Model.html"
              >
                
                Modeling Single Subject Data
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/features/notebooks/11_Group_Analysis">
              <a class="c-sidebar__entry"
                href="/features/notebooks/11_Group_Analysis.html"
              >
                
                Group Analysis
              </a>
            </li>
            
            
          
            
            

            
            
            
            

            <li class="c-sidebar__section" data-url="/features/notebooks/12_Thresholding_Group_Analyses">
              <a class="c-sidebar__entry"
                href="/features/notebooks/12_Thresholding_Group_Analyses.html"
              >
                
                Thresholding Group Analyses
              </a>
            </li>
            
            
          
        </ul>
      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/notebooks/13_Connectivity">
        <a class="c-sidebar__entry"
          href="/features/notebooks/13_Connectivity.html"
        >
          
            7.
          
          Connectivity
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/notebooks/14_Multivariate_Prediction">
        <a class="c-sidebar__entry"
          href="/features/notebooks/14_Multivariate_Prediction.html"
        >
          
            8.
          
          Multivariate Prediction
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/notebooks/15_RSA">
        <a class="c-sidebar__entry"
          href="/features/notebooks/15_RSA.html"
        >
          
            9.
          
          Representational Similarity Analysis
        </a>
      </li>

      
      

      

      
      

      

      
    
      
      
        <li class="c-sidebar__divider"></li>
        
      
      

      
      
      
      

      
      
      <li class="c-sidebar__chapter" data-url="/features/markdown/Project_Gallery">
        <a class="c-sidebar__entry"
          href="/features/markdown/Project_Gallery.html"
        >
          
          Project Gallery
        </a>
      </li>

      
      

      

      
      

      

      
    
  </ul>
  <p class="sidebar_footer">Powered by <a href="https://github.com/jupyter/jupyter-book">Jupyter Book</a></p>
</nav>

      
      <div class="c-topbar" id="top-navbar">
  <!-- We show the sidebar by default so we use .is-active -->
  <div class="c-topbar__buttons">
    <button
      id="js-sidebar-toggle"
      class="hamburger hamburger--arrowalt is-active"
    >
      <span class="hamburger-box">
        <span class="hamburger-inner"></span>
      </span>
    </button>
    <div class="buttons">
<div class="download-buttons-dropdown">
    <button id="dropdown-button-trigger" class="interact-button"><img src="/assets/images/download-solid.svg" alt="Download" /></button>
    <div class="download-buttons">
        <a href="/content/features/notebooks/6_Nipype_Quickstart.ipynb" download>
        <button id="interact-button-download" class="interact-button">.ipynb</button>
        </a>
        
        <a id="interact-button-print"><button id="interact-button-download" class="interact-button">.pdf</button></a>
    </div>
</div>


  
  
  






<a href="https://mybinder.org/v2/gh/ljchang/dartbrains/master?filepath=content%2Ffeatures%2Fnotebooks%2F6_Nipype_Quickstart.ipynb"><button class="interact-button" id="interact-button-binder"><img class="interact-button-logo" src="/assets/images/logo_binder.svg" alt="Interact" />Interact</button></a>
  





<a href="https://jupyterhub.dartmouth.edu/hub/user-redirect/git-pull?repo=https://github.com/ljchang/dartbrains/ljchang/dartbrains&amp;branch=master&amp;subPath=content%2Ffeatures%2Fnotebooks%2F6_Nipype_Quickstart.ipynb&amp;app=notebook"><button class="interact-button" id="interact-button-jupyterhub"><img class="interact-button-logo" src="/assets/images/logo_jupyterhub.svg" alt="Interact" />Interact</button></a>




</div>

  </div>
  <!-- Empty sidebar placeholder that we'll auto-fill with javascript -->
  <aside class="sidebar__right">
    <header><h4 class="nav__title"><img src="/assets/images/list-solid.svg" alt="Search" />   On this page</h4></header>
    <nav class="onthispage">
    </nav>
  </aside>
  <a href="/search.html" class="topbar-right-button" id="search-button">
    <img src="/assets/images/search-solid.svg" alt="Search" />
  </a>
</div>

      <main class="c-textbook__page" tabindex="-1">
            <div class="c-textbook__content" id="textbook_content">
                  <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Preprocessing with Nipype Quickstart</div>
</div>
    
<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Nipype-Quickstart">Nipype Quickstart<a class="anchor-link" href="#Nipype-Quickstart"> </a></h1><p><em>Written by Michael Notter</em></p>
<p>Here we will provide a quick introduction to some of the concepts of <a href="https://nipype.readthedocs.io/en/latest/">nipype</a>. This quick introduction is taken from a very comprehensive <a href="https://github.com/miykael/nipype_tutorial">nipype tutorial</a>. I highly encourage you to spend some time with the tutorial if you are interested in learning about nipype in more detail</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="https://raw.github.com/satra/intro2nipype/master/images/arch.png" alt="Nipype architecture"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><p><a href="http://nipype.readthedocs.io/en/latest/">Existing documentation</a></p>
</li>
<li><p><a href="https://www.youtube.com/watch?v=cofpD1lhmKU">Visualizing the evolution of Nipype</a></p>
</li>
<li><p>This notebook is taken from <a href="https://github.com/ReproNim/reproducible-imaging">reproducible-imaging repository</a></p>
</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Import-a-few-things-from-nipype-and-external-libraries">Import a few things from nipype and external libraries<a class="anchor-link" href="#Import-a-few-things-from-nipype-and-external-libraries"> </a></h4>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="k">import</span> <span class="n">abspath</span><span class="p">,</span> <span class="n">join</span>

<span class="kn">from</span> <span class="nn">nipype</span> <span class="k">import</span> <span class="n">Workflow</span><span class="p">,</span> <span class="n">Node</span><span class="p">,</span> <span class="n">MapNode</span><span class="p">,</span> <span class="n">Function</span>
<span class="kn">from</span> <span class="nn">nipype.interfaces.fsl</span> <span class="k">import</span> <span class="n">BET</span><span class="p">,</span> <span class="n">IsotropicSmooth</span><span class="p">,</span> <span class="n">ApplyMask</span>

<span class="kn">from</span> <span class="nn">nilearn.plotting</span> <span class="k">import</span> <span class="n">plot_anat</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">your_netid</span> <span class="o">=</span> <span class="s1">&#39;f00275v&#39;</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="s1">&#39;/dartfs/rc/lab/P/Psych60/data/ds000114&#39;</span>
<span class="n">output_dir</span> <span class="o">=</span> <span class="s1">&#39;/dartfs-hpc/rc/home/v/f00275v/Psych60/students_output/</span><span class="si">%s</span><span class="s1">/6_nipype&#39;</span> <span class="o">%</span> <span class="n">your_netid</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/optnfs/el7/jupyterhub/envs/Psych60-Chang/lib/python3.7/importlib/_bootstrap.py:219: RuntimeWarning: numpy.ufunc size changed, may indicate binary incompatibility. Expected 192 from C header, got 216 from PyObject
  return f(*args, **kwds)
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Interfaces">Interfaces<a class="anchor-link" href="#Interfaces"> </a></h2><p>Interfaces are the core pieces of Nipype. The interfaces are python modules that allow you to use various external packages (e.g. FSL, SPM or FreeSurfer), even if they themselves are written in another programming language than python.</p>
<p><strong>Let's try to use <code>bet</code> from FSL:</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># will use a T1w from ds000114 dataset</span>
<span class="n">input_file</span> <span class="o">=</span>  <span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;sub-01/ses-test/anat/sub-01_ses-test_T1w.nii.gz&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># we will be typing here</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you're lost the code is here:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bet</span> <span class="o">=</span> <span class="n">BET</span><span class="p">()</span>
<span class="n">bet</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="n">input_file</span>
<span class="n">bet</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">out_file</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;output/T1w_nipype_bet.nii.gz&quot;</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">bet</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>let's check the output:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">outputs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>
inskull_mask_file = &lt;undefined&gt;
inskull_mesh_file = &lt;undefined&gt;
mask_file = &lt;undefined&gt;
meshfile = &lt;undefined&gt;
out_file = /dartfs-hpc/rc/home/v/f00275v/Psych60/students_output/f00275v/6_nipype/output/T1w_nipype_bet.nii.gz
outline_file = &lt;undefined&gt;
outskin_mask_file = &lt;undefined&gt;
outskin_mesh_file = &lt;undefined&gt;
outskull_mask_file = &lt;undefined&gt;
outskull_mesh_file = &lt;undefined&gt;
skull_mask_file = &lt;undefined&gt;</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>and we can plot the output file</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plot_anat</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s1">&#39;output/T1w_nipype_bet.nii.gz&#39;</span><span class="p">),</span> 
          <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">draw_cross</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">annotate</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/optnfs/el7/jupyterhub/envs/Psych60-Chang/lib/python3.7/site-packages/scipy/ndimage/measurements.py:272: DeprecationWarning: In future, it will be an error for &#39;np.bool_&#39; scalars to be interpreted as an index
  return _nd_image.find_objects(input, max_label)
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/features/notebooks/6_Nipype_Quickstart_13_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>you can always check the list of arguments using <code>help</code> method</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">BET</span><span class="o">.</span><span class="n">help</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Wraps the executable command ``bet``.

FSL BET wrapper for skull stripping

For complete details, see the `BET Documentation.
&lt;https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/BET/UserGuide&gt;`_

Examples
--------
&gt;&gt;&gt; from nipype.interfaces import fsl
&gt;&gt;&gt; btr = fsl.BET()
&gt;&gt;&gt; btr.inputs.in_file = &#39;structural.nii&#39;
&gt;&gt;&gt; btr.inputs.frac = 0.7
&gt;&gt;&gt; btr.inputs.out_file = &#39;brain_anat.nii&#39;
&gt;&gt;&gt; btr.cmdline
&#39;bet structural.nii brain_anat.nii -f 0.70&#39;
&gt;&gt;&gt; res = btr.run() # doctest: +SKIP

Inputs::

        [Mandatory]
        in_file: (an existing file name)
                input file to skull strip
                argument: ``%s``, position: 0

        [Optional]
        out_file: (a file name)
                name of output skull stripped image
                argument: ``%s``, position: 1
        outline: (a boolean)
                create surface outline image
                argument: ``-o``
        mask: (a boolean)
                create binary mask image
                argument: ``-m``
        skull: (a boolean)
                create skull image
                argument: ``-s``
        no_output: (a boolean)
                Don&#39;t generate segmented output
                argument: ``-n``
        frac: (a float)
                fractional intensity threshold
                argument: ``-f %.2f``
        vertical_gradient: (a float)
                vertical gradient in fractional intensity threshold (-1, 1)
                argument: ``-g %.2f``
        radius: (an integer (int or long))
                head radius
                argument: ``-r %d``
        center: (a list of at most 3 items which are an integer (int or
                  long))
                center of gravity in voxels
                argument: ``-c %s``
        threshold: (a boolean)
                apply thresholding to segmented brain image and mask
                argument: ``-t``
        mesh: (a boolean)
                generate a vtk mesh brain surface
                argument: ``-e``
        robust: (a boolean)
                robust brain centre estimation (iterates BET several times)
                argument: ``-R``
                mutually_exclusive: functional, reduce_bias, robust, padding,
                  remove_eyes, surfaces, t2_guided
        padding: (a boolean)
                improve BET if FOV is very small in Z (by temporarily padding end
                slices)
                argument: ``-Z``
                mutually_exclusive: functional, reduce_bias, robust, padding,
                  remove_eyes, surfaces, t2_guided
        remove_eyes: (a boolean)
                eye &amp; optic nerve cleanup (can be useful in SIENA)
                argument: ``-S``
                mutually_exclusive: functional, reduce_bias, robust, padding,
                  remove_eyes, surfaces, t2_guided
        surfaces: (a boolean)
                run bet2 and then betsurf to get additional skull and scalp surfaces
                (includes registrations)
                argument: ``-A``
                mutually_exclusive: functional, reduce_bias, robust, padding,
                  remove_eyes, surfaces, t2_guided
        t2_guided: (a file name)
                as with creating surfaces, when also feeding in non-brain-extracted
                T2 (includes registrations)
                argument: ``-A2 %s``
                mutually_exclusive: functional, reduce_bias, robust, padding,
                  remove_eyes, surfaces, t2_guided
        functional: (a boolean)
                apply to 4D fMRI data
                argument: ``-F``
                mutually_exclusive: functional, reduce_bias, robust, padding,
                  remove_eyes, surfaces, t2_guided
        reduce_bias: (a boolean)
                bias field and neck cleanup
                argument: ``-B``
                mutually_exclusive: functional, reduce_bias, robust, padding,
                  remove_eyes, surfaces, t2_guided
        output_type: (&#39;NIFTI&#39; or &#39;NIFTI_PAIR&#39; or &#39;NIFTI_GZ&#39; or
                  &#39;NIFTI_PAIR_GZ&#39;)
                FSL output type
        args: (a unicode string)
                Additional parameters to the command
                argument: ``%s``
        environ: (a dictionary with keys which are a bytes or None or a value
                  of class &#39;str&#39; and with values which are a bytes or None or a
                  value of class &#39;str&#39;, nipype default value: {})
                Environment variables

Outputs::

        out_file: (a file name)
                path/name of skullstripped file (if generated)
        mask_file: (a file name)
                path/name of binary brain mask (if generated)
        outline_file: (a file name)
                path/name of outline file (if generated)
        meshfile: (a file name)
                path/name of vtk mesh file (if generated)
        inskull_mask_file: (a file name)
                path/name of inskull mask (if generated)
        inskull_mesh_file: (a file name)
                path/name of inskull mesh outline (if generated)
        outskull_mask_file: (a file name)
                path/name of outskull mask (if generated)
        outskull_mesh_file: (a file name)
                path/name of outskull mesh outline (if generated)
        outskin_mask_file: (a file name)
                path/name of outskin mask (if generated)
        outskin_mesh_file: (a file name)
                path/name of outskin mesh outline (if generated)
        skull_mask_file: (a file name)
                path/name of skull mask (if generated)

References:
-----------
None
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Exercise-1a">Exercise 1a<a class="anchor-link" href="#Exercise-1a"> </a></h4><p>Import <code>IsotropicSmooth</code> from <code>nipype.interfaces.fsl</code> and find out the <code>FSL</code> command that is being run. What are the mandatory inputs for this interface?</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># type your code here</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nipype.interfaces.fsl</span> <span class="k">import</span> <span class="n">IsotropicSmooth</span>
<span class="c1"># all this information can be found when we run `help` method. </span>
<span class="c1"># note that you can either provide `in_file` and `fwhm` or `in_file` and `sigma`</span>
<span class="n">IsotropicSmooth</span><span class="o">.</span><span class="n">help</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Wraps the executable command ``fslmaths``.

Use fslmaths to spatially smooth an image with a gaussian kernel.

Inputs::

        [Mandatory]
        fwhm: (a float)
                fwhm of smoothing kernel [mm]
                argument: ``-s %.5f``, position: 4
                mutually_exclusive: sigma
        sigma: (a float)
                sigma of smoothing kernel [mm]
                argument: ``-s %.5f``, position: 4
                mutually_exclusive: fwhm
        in_file: (an existing file name)
                image to operate on
                argument: ``%s``, position: 2

        [Optional]
        out_file: (a file name)
                image to write
                argument: ``%s``, position: -2
        internal_datatype: (&#39;float&#39; or &#39;char&#39; or &#39;int&#39; or &#39;short&#39; or &#39;double&#39;
                  or &#39;input&#39;)
                datatype to use for calculations (default is float)
                argument: ``-dt %s``, position: 1
        output_datatype: (&#39;float&#39; or &#39;char&#39; or &#39;int&#39; or &#39;short&#39; or &#39;double&#39;
                  or &#39;input&#39;)
                datatype to use for output (default uses input type)
                argument: ``-odt %s``, position: -1
        nan2zeros: (a boolean)
                change NaNs to zeros before doing anything
                argument: ``-nan``, position: 3
        output_type: (&#39;NIFTI&#39; or &#39;NIFTI_PAIR&#39; or &#39;NIFTI_GZ&#39; or
                  &#39;NIFTI_PAIR_GZ&#39;)
                FSL output type
        args: (a unicode string)
                Additional parameters to the command
                argument: ``%s``
        environ: (a dictionary with keys which are a bytes or None or a value
                  of class &#39;str&#39; and with values which are a bytes or None or a
                  value of class &#39;str&#39;, nipype default value: {})
                Environment variables

Outputs::

        out_file: (an existing file name)
                image written after calculations

References:
-----------
None
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Exercise-1b">Exercise 1b<a class="anchor-link" href="#Exercise-1b"> </a></h4><p>Run the <code>IsotropicSmooth</code> for <code>/data/ds000114/sub-01/ses-test/anat/sub-01_ses-test_T1w.nii.gz</code> file with a smoothing kernel 4mm:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># type your solution here</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smoothing</span> <span class="o">=</span> <span class="n">IsotropicSmooth</span><span class="p">()</span>
<span class="n">smoothing</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;sub-01/ses-test/anat/sub-01_ses-test_T1w.nii.gz&quot;</span><span class="p">)</span>
<span class="n">smoothing</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">fwhm</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">smoothing</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">out_file</span> <span class="o">=</span> <span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;output/T1w_nipype_smooth.nii.gz&quot;</span><span class="p">)</span>
<span class="n">smoothing</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;nipype.interfaces.base.support.InterfaceResult at 0x2ad2754731d0&gt;</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># plotting the output</span>
<span class="n">plot_anat</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s1">&#39;output/T1w_nipype_smooth.nii.gz&#39;</span><span class="p">)),</span> 
          <span class="n">display_mode</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">draw_cross</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">annotate</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/optnfs/el7/jupyterhub/envs/Psych60-Chang/lib/python3.7/site-packages/scipy/ndimage/measurements.py:272: DeprecationWarning: In future, it will be an error for &#39;np.bool_&#39; scalars to be interpreted as an index
  return _nd_image.find_objects(input, max_label)
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/features/notebooks/6_Nipype_Quickstart_22_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Nodes-and-Workflows">Nodes and Workflows<a class="anchor-link" href="#Nodes-and-Workflows"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Interfaces are the core pieces of Nipype that run the code of your desire. But to streamline your analysis and to execute multiple interfaces in a sensible order, you have to put them in something that we call a Node and create a Workflow.</p>
<p>In Nipype, a node is an object that executes a certain function. This function can be anything from a Nipype interface to a user-specified function or an external script. Each node consists of a name, an interface, and at least one input field and at least one output field.</p>
<p>Once you have multiple nodes you can use <code>Workflow</code> to connect with each other and create a directed graph. Nipype workflow will take care of input and output of each interface and arrange the execution of each interface in the most efficient way.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's create the first node using <code>BET</code> interface:</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># we will be typing here</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If you're lost the code is here:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create Node</span>
<span class="n">bet_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">BET</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;bet&#39;</span><span class="p">)</span>
<span class="c1"># Specify node inputs</span>
<span class="n">bet_node</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">in_file</span> <span class="o">=</span> <span class="n">input_file</span>
<span class="n">bet_node</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># bet node can be also defined this way:</span>
<span class="c1">#bet_node = Node(BET(in_file=input_file, mask=True), name=&#39;bet_node&#39;)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Exercise-2">Exercise 2<a class="anchor-link" href="#Exercise-2"> </a></h4><p>Create a <code>Node</code> for IsotropicSmooth interface.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Type your solution here:</span>

<span class="c1"># smooth_node = </span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smooth_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">IsotropicSmooth</span><span class="p">(</span><span class="n">in_file</span><span class="o">=</span><span class="n">input_file</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mi">4</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;smooth&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>We will now create one more Node for our workflow</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mask_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ApplyMask</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mask&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's check the interface:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ApplyMask</span><span class="o">.</span><span class="n">help</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Wraps the executable command ``fslmaths``.

Use fslmaths to apply a binary mask to another image.

Inputs::

        [Mandatory]
        mask_file: (an existing file name)
                binary image defining mask space
                argument: ``-mas %s``, position: 4
        in_file: (an existing file name)
                image to operate on
                argument: ``%s``, position: 2

        [Optional]
        out_file: (a file name)
                image to write
                argument: ``%s``, position: -2
        internal_datatype: (&#39;float&#39; or &#39;char&#39; or &#39;int&#39; or &#39;short&#39; or &#39;double&#39;
                  or &#39;input&#39;)
                datatype to use for calculations (default is float)
                argument: ``-dt %s``, position: 1
        output_datatype: (&#39;float&#39; or &#39;char&#39; or &#39;int&#39; or &#39;short&#39; or &#39;double&#39;
                  or &#39;input&#39;)
                datatype to use for output (default uses input type)
                argument: ``-odt %s``, position: -1
        nan2zeros: (a boolean)
                change NaNs to zeros before doing anything
                argument: ``-nan``, position: 3
        output_type: (&#39;NIFTI&#39; or &#39;NIFTI_PAIR&#39; or &#39;NIFTI_GZ&#39; or
                  &#39;NIFTI_PAIR_GZ&#39;)
                FSL output type
        args: (a unicode string)
                Additional parameters to the command
                argument: ``%s``
        environ: (a dictionary with keys which are a bytes or None or a value
                  of class &#39;str&#39; and with values which are a bytes or None or a
                  value of class &#39;str&#39;, nipype default value: {})
                Environment variables

Outputs::

        out_file: (an existing file name)
                image written after calculations

References:
-----------
None
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see the interface takes two mandatory inputs: <code>in_file</code> and <code>mask_file</code>. We want to use the output of <code>smooth_node</code> as <code>in_file</code> and one of the output of <code>bet_file</code> (the <code>mask_file</code>) as <code>mask_file</code> input.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong> Let's initialize a <code>Workflow</code>:</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># will be writing the code here:</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>if you're lost, the full code is here:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Initiation of a workflow</span>
<span class="n">wf</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;smoothflow&quot;</span><span class="p">,</span> <span class="n">base_dir</span><span class="o">=</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;output/working_dir&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/optnfs/el7/jupyterhub/envs/Psych60-Chang/lib/python3.7/site-packages/networkx/classes/graph.py:23: DeprecationWarning: Using or importing the ABCs from &#39;collections&#39; instead of from &#39;collections.abc&#39; is deprecated, and in 3.8 it will stop working
  from collections import Mapping
/optnfs/el7/jupyterhub/envs/Psych60-Chang/lib/python3.7/site-packages/networkx/classes/reportviews.py:95: DeprecationWarning: Using or importing the ABCs from &#39;collections&#39; instead of from &#39;collections.abc&#39; is deprecated, and in 3.8 it will stop working
  from collections import Mapping, Set, Iterable
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It's very important to specify <code>base_dir</code> (as absolute path), because otherwise all the outputs would be saved somewhere in the temporary files.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>let's connect the <code>bet_node</code> output to <code>mask_node</code> input`</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># we will be typing here:</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>if you're lost, the code is here:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wf</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">bet_node</span><span class="p">,</span> <span class="s2">&quot;mask_file&quot;</span><span class="p">,</span> <span class="n">mask_node</span><span class="p">,</span> <span class="s2">&quot;mask_file&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Exercise-3">Exercise 3<a class="anchor-link" href="#Exercise-3"> </a></h4><p>Connect <code>out_file</code> of <code>smooth_node</code> to <code>in_file</code> of <code>mask_node</code>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># type your code here</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wf</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">smooth_node</span><span class="p">,</span> <span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">mask_node</span><span class="p">,</span> <span class="s2">&quot;in_file&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">Exception</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-31-10c8e9bd9701&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>wf<span class="ansi-blue-fg">.</span>connect<span class="ansi-blue-fg">(</span>smooth_node<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;out_file&#34;</span><span class="ansi-blue-fg">,</span> mask_node<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;in_file&#34;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/optnfs/el7/jupyterhub/envs/Psych60-Chang/lib/python3.7/site-packages/nipype/pipeline/engine/workflows.py</span> in <span class="ansi-cyan-fg">connect</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    178</span> Trying to connect <span class="ansi-blue-fg">%</span>s<span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">%</span>s to <span class="ansi-blue-fg">%</span>s<span class="ansi-blue-fg">:</span><span class="ansi-blue-fg">%</span>s but input <span class="ansi-blue-fg">&#39;%s&#39;</span> of node <span class="ansi-blue-fg">&#39;%s&#39;</span> <span class="ansi-green-fg">is</span> already
<span class="ansi-green-intense-fg ansi-bold">    179</span> connected<span class="ansi-blue-fg">.</span>
<span class="ansi-green-fg">--&gt; 180</span><span class="ansi-red-fg"> &#34;&#34;&#34; % (srcnode, source, destnode, dest, dest, destnode))
</span><span class="ansi-green-intense-fg ansi-bold">    181</span>                 if not (hasattr(destnode, &#39;_interface&#39;) and
<span class="ansi-green-intense-fg ansi-bold">    182</span>                         (&#39;.io&#39; in str(destnode._interface.__class__) or any([

<span class="ansi-red-fg">Exception</span>: Trying to connect smoothflow.smooth:out_file to smoothflow.mask:in_file but input &#39;in_file&#39; of node &#39;smoothflow.mask&#39; is already
connected.
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Let's see a graph describing our workflow:</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wf</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;output/working_dir/smoothflow/workflow_graph.dot&quot;</span><span class="p">))</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;output/working_dir/smoothflow/workflow_graph.png&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>190416-10:03:54,39 nipype.workflow INFO:
	 Generated workflow graph: /dartfs-hpc/rc/home/v/f00275v/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow/workflow_graph.png (graph2use=hierarchical, simple_form=True).
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="../../images/features/notebooks/6_Nipype_Quickstart_50_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>you can also plot a more detailed graph:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">wf</span><span class="o">.</span><span class="n">write_graph</span><span class="p">(</span><span class="n">graph2use</span><span class="o">=</span><span class="s1">&#39;flat&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="k">import</span> <span class="n">Image</span>
<span class="n">Image</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;output/working_dir/smoothflow/graph_detailed.png&quot;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>190416-10:03:57,249 nipype.workflow INFO:
	 Generated workflow graph: /dartfs-hpc/rc/home/v/f00275v/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow/graph.png (graph2use=flat, simple_form=True).
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="../../images/features/notebooks/6_Nipype_Quickstart_52_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>and now let's run the workflow</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># we will type our code here:</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>if you're lost, the full code is here:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Execute the workflow</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">wf</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>190416-10:04:12,972 nipype.workflow INFO:
	 Workflow smoothflow settings: [&#39;check&#39;, &#39;execution&#39;, &#39;logging&#39;, &#39;monitoring&#39;]
190416-10:04:13,127 nipype.workflow INFO:
	 Running serially.
190416-10:04:13,128 nipype.workflow INFO:
	 [Node] Setting-up &#34;smoothflow.smooth&#34; in &#34;/dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow/smooth&#34;.
190416-10:04:13,208 nipype.workflow INFO:
	 [Node] Running &#34;smooth&#34; (&#34;nipype.interfaces.fsl.maths.IsotropicSmooth&#34;), a CommandLine Interface with command:
fslmaths /dartfs-hpc/rc/home/v/f00275v/Psych60/data/ds000114/sub-01/ses-test/anat/sub-01_ses-test_T1w.nii.gz -s 1.69864 /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow/smooth/sub-01_ses-test_T1w_smooth.nii.gz
190416-10:04:30,781 nipype.workflow INFO:
	 [Node] Finished &#34;smoothflow.smooth&#34;.
190416-10:04:30,784 nipype.workflow INFO:
	 [Node] Setting-up &#34;smoothflow.bet&#34; in &#34;/dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow/bet&#34;.
190416-10:04:30,837 nipype.workflow INFO:
	 [Node] Running &#34;bet&#34; (&#34;nipype.interfaces.fsl.preprocess.BET&#34;), a CommandLine Interface with command:
bet /dartfs-hpc/rc/home/v/f00275v/Psych60/data/ds000114/sub-01/ses-test/anat/sub-01_ses-test_T1w.nii.gz /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow/bet/sub-01_ses-test_T1w_brain.nii.gz -m
190416-10:04:39,204 nipype.workflow INFO:
	 [Node] Finished &#34;smoothflow.bet&#34;.
190416-10:04:39,206 nipype.workflow INFO:
	 [Node] Setting-up &#34;smoothflow.mask&#34; in &#34;/dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow/mask&#34;.
190416-10:04:39,292 nipype.workflow INFO:
	 [Node] Running &#34;mask&#34; (&#34;nipype.interfaces.fsl.maths.ApplyMask&#34;), a CommandLine Interface with command:
fslmaths /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow/smooth/sub-01_ses-test_T1w_smooth.nii.gz -mas /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow/bet/sub-01_ses-test_T1w_brain_mask.nii.gz /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow/mask/sub-01_ses-test_T1w_smooth_masked.nii.gz
190416-10:04:42,511 nipype.workflow INFO:
	 [Node] Finished &#34;smoothflow.mask&#34;.
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>and let's look at the results</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># we can check the output of specific nodes from workflow</span>
<span class="nb">list</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">nodes</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">outputs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>
inskull_mask_file = &lt;undefined&gt;
inskull_mesh_file = &lt;undefined&gt;
mask_file = /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow/bet/sub-01_ses-test_T1w_brain_mask.nii.gz
meshfile = &lt;undefined&gt;
out_file = &lt;undefined&gt;
outline_file = &lt;undefined&gt;
outskin_mask_file = &lt;undefined&gt;
outskin_mesh_file = &lt;undefined&gt;
outskull_mask_file = &lt;undefined&gt;
outskull_mesh_file = &lt;undefined&gt;
skull_mask_file = &lt;undefined&gt;</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see the fie structure that has been created.</p>
<p><strong>NOTE</strong>: <code>tree</code> is not currently installed on our system so we can ignore this line for now.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> tree -L <span class="m">3</span> <span class="o">{</span><span class="s1">&#39;/dartfs-hpc/rc/home/v/&#39;</span> + your_netid + <span class="s1">&#39;/Psych60/students_output/&#39;</span> + your_netid + <span class="s1">&#39;/6_nipype/output/working_dir/smoothflow/&#39;</span><span class="o">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/dartfs-hpc/rc/home/v/f00275v/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow/
|-- bet
|   |-- _0xea357d12a50dbd994accbae278895201.json
|   |-- command.txt
|   |-- _inputs.pklz
|   |-- _node.pklz
|   |-- _report
|   |   `-- report.rst
|   |-- result_bet.pklz
|   `-- sub-01_ses-test_T1w_brain_mask.nii.gz
|-- d3.js
|-- graph1.json
|-- graph_detailed.dot
|-- graph_detailed.png
|-- graph.dot
|-- graph.json
|-- graph.png
|-- index.html
|-- mask
|   |-- _0xec44a1986ad59e4d922a84d43e4b3528.json
|   |-- command.txt
|   |-- _inputs.pklz
|   |-- _node.pklz
|   |-- _report
|   |   `-- report.rst
|   |-- result_mask.pklz
|   `-- sub-01_ses-test_T1w_smooth_masked.nii.gz
|-- smooth
|   |-- _0x7218167d46551014f0f633e94d8027fc.json
|   |-- command.txt
|   |-- _inputs.pklz
|   |-- _node.pklz
|   |-- _report
|   |   `-- report.rst
|   |-- result_smooth.pklz
|   `-- sub-01_ses-test_T1w_smooth.nii.gz
|-- workflow_graph.dot
`-- workflow_graph.png

6 directories, 31 files
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>and we can plot the results:</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nibabel</span> <span class="k">as</span> <span class="nn">nb</span>
<span class="c1">#import matplotlib.pyplot as plt</span>

<span class="c1"># Let&#39;s create a short helper function to plot 3D NIfTI images</span>
<span class="k">def</span> <span class="nf">plot_slice</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>

    <span class="c1"># Load the image</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">nb</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>

    <span class="c1"># Cut in the middle of the brain</span>
    <span class="n">cut</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span>

    <span class="c1"># Plot the data</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">rot90</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">cut</span><span class="p">]),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">img</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="n">join</span><span class="p">(</span><span class="n">data_dir</span><span class="p">,</span> <span class="s2">&quot;sub-01/ses-test/anat/sub-01_ses-test_T1w.nii.gz&quot;</span><span class="p">),</span>
                         <span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;output/working_dir/smoothflow/smooth/sub-01_ses-test_T1w_smooth.nii.gz&quot;</span><span class="p">),</span>
                         <span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;output/working_dir/smoothflow/bet/sub-01_ses-test_T1w_brain_mask.nii.gz&quot;</span><span class="p">),</span>
                         <span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;output/working_dir/smoothflow/mask/sub-01_ses-test_T1w_smooth_masked.nii.gz&quot;</span><span class="p">)]):</span>
    <span class="n">f</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plot_slice</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../../images/features/notebooks/6_Nipype_Quickstart_62_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Iterables">Iterables<a class="anchor-link" href="#Iterables"> </a></h2><p>Some steps in a neuroimaging analysis are repetitive. Running the same preprocessing on multiple subjects or doing statistical inference on multiple files. To prevent the creation of multiple individual scripts, Nipype has as execution plugin for <code>Workflow</code>, called <strong><code>iterables</code></strong>.</p>
<p><img src="../../images/nipype/iterables.png" alt="file_tree"></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's assume we have a workflow with two nodes, node (A) does simple skull stripping, and is followed by a node (B) that does isometric smoothing. Now, let's say, that we are curious about the effect of different smoothing kernels. Therefore, we want to run the smoothing node with FWHM set to 2mm, 8mm, and 16mm.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>let's just modify <code>smooth_node</code>:</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># we will type the code here</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>if you're lost the code is here:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">smooth_node_it</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">IsotropicSmooth</span><span class="p">(</span><span class="n">in_file</span><span class="o">=</span><span class="n">input_file</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;smooth&quot;</span><span class="p">)</span>
<span class="n">smooth_node_it</span><span class="o">.</span><span class="n">iterables</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;fwhm&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>we will define again bet and smooth nodes:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bet_node_it</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">BET</span><span class="p">(</span><span class="n">in_file</span><span class="o">=</span><span class="n">input_file</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;bet_node&#39;</span><span class="p">)</span>
<span class="n">mask_node_it</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ApplyMask</span><span class="p">(),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;mask&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong> will create a new workflow with a new <code>base_dir</code>:</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Initiation of a workflow</span>
<span class="n">wf_it</span> <span class="o">=</span> <span class="n">Workflow</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;smoothflow_it&quot;</span><span class="p">,</span> <span class="n">base_dir</span><span class="o">=</span><span class="n">join</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;output/working_dir&quot;</span><span class="p">))</span>
<span class="n">wf_it</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">bet_node_it</span><span class="p">,</span> <span class="s2">&quot;mask_file&quot;</span><span class="p">,</span> <span class="n">mask_node_it</span><span class="p">,</span> <span class="s2">&quot;mask_file&quot;</span><span class="p">)</span>
<span class="n">wf_it</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">smooth_node_it</span><span class="p">,</span> <span class="s2">&quot;out_file&quot;</span><span class="p">,</span> <span class="n">mask_node_it</span><span class="p">,</span> <span class="s2">&quot;in_file&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>let's run the workflow and check the output</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">res_it</span> <span class="o">=</span> <span class="n">wf_it</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>190416-10:16:18,493 nipype.workflow INFO:
	 Workflow smoothflow_it settings: [&#39;check&#39;, &#39;execution&#39;, &#39;logging&#39;, &#39;monitoring&#39;]
190416-10:16:18,668 nipype.workflow INFO:
	 Running serially.
190416-10:16:18,670 nipype.workflow INFO:
	 [Node] Setting-up &#34;smoothflow_it.smooth&#34; in &#34;/dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_16/smooth&#34;.
190416-10:16:18,731 nipype.workflow INFO:
	 [Node] Running &#34;smooth&#34; (&#34;nipype.interfaces.fsl.maths.IsotropicSmooth&#34;), a CommandLine Interface with command:
fslmaths /dartfs-hpc/rc/home/v/f00275v/Psych60/data/ds000114/sub-01/ses-test/anat/sub-01_ses-test_T1w.nii.gz -s 6.79457 /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_16/smooth/sub-01_ses-test_T1w_smooth.nii.gz
190416-10:16:57,727 nipype.workflow INFO:
	 [Node] Finished &#34;smoothflow_it.smooth&#34;.
190416-10:16:57,730 nipype.workflow INFO:
	 [Node] Setting-up &#34;smoothflow_it.smooth&#34; in &#34;/dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_8/smooth&#34;.
190416-10:16:57,797 nipype.workflow INFO:
	 [Node] Running &#34;smooth&#34; (&#34;nipype.interfaces.fsl.maths.IsotropicSmooth&#34;), a CommandLine Interface with command:
fslmaths /dartfs-hpc/rc/home/v/f00275v/Psych60/data/ds000114/sub-01/ses-test/anat/sub-01_ses-test_T1w.nii.gz -s 3.39729 /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_8/smooth/sub-01_ses-test_T1w_smooth.nii.gz
190416-10:17:20,399 nipype.workflow INFO:
	 [Node] Finished &#34;smoothflow_it.smooth&#34;.
190416-10:17:20,401 nipype.workflow INFO:
	 [Node] Setting-up &#34;smoothflow_it.smooth&#34; in &#34;/dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_4/smooth&#34;.
190416-10:17:20,467 nipype.workflow INFO:
	 [Node] Running &#34;smooth&#34; (&#34;nipype.interfaces.fsl.maths.IsotropicSmooth&#34;), a CommandLine Interface with command:
fslmaths /dartfs-hpc/rc/home/v/f00275v/Psych60/data/ds000114/sub-01/ses-test/anat/sub-01_ses-test_T1w.nii.gz -s 1.69864 /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_4/smooth/sub-01_ses-test_T1w_smooth.nii.gz
190416-10:17:36,505 nipype.workflow INFO:
	 [Node] Finished &#34;smoothflow_it.smooth&#34;.
190416-10:17:36,508 nipype.workflow INFO:
	 [Node] Setting-up &#34;smoothflow_it.bet_node&#34; in &#34;/dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/bet_node&#34;.
190416-10:17:36,604 nipype.workflow INFO:
	 [Node] Running &#34;bet_node&#34; (&#34;nipype.interfaces.fsl.preprocess.BET&#34;), a CommandLine Interface with command:
bet /dartfs-hpc/rc/home/v/f00275v/Psych60/data/ds000114/sub-01/ses-test/anat/sub-01_ses-test_T1w.nii.gz /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/bet_node/sub-01_ses-test_T1w_brain.nii.gz -m
190416-10:17:44,948 nipype.workflow INFO:
	 [Node] Finished &#34;smoothflow_it.bet_node&#34;.
190416-10:17:44,951 nipype.workflow INFO:
	 [Node] Setting-up &#34;smoothflow_it.mask&#34; in &#34;/dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_16/mask&#34;.
190416-10:17:45,15 nipype.workflow INFO:
	 [Node] Running &#34;mask&#34; (&#34;nipype.interfaces.fsl.maths.ApplyMask&#34;), a CommandLine Interface with command:
fslmaths /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_16/smooth/sub-01_ses-test_T1w_smooth.nii.gz -mas /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/bet_node/sub-01_ses-test_T1w_brain_mask.nii.gz /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_16/mask/sub-01_ses-test_T1w_smooth_masked.nii.gz
190416-10:17:48,335 nipype.workflow INFO:
	 [Node] Finished &#34;smoothflow_it.mask&#34;.
190416-10:17:48,337 nipype.workflow INFO:
	 [Node] Setting-up &#34;smoothflow_it.mask&#34; in &#34;/dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_8/mask&#34;.
190416-10:17:48,405 nipype.workflow INFO:
	 [Node] Running &#34;mask&#34; (&#34;nipype.interfaces.fsl.maths.ApplyMask&#34;), a CommandLine Interface with command:
fslmaths /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_8/smooth/sub-01_ses-test_T1w_smooth.nii.gz -mas /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/bet_node/sub-01_ses-test_T1w_brain_mask.nii.gz /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_8/mask/sub-01_ses-test_T1w_smooth_masked.nii.gz
190416-10:17:51,474 nipype.workflow INFO:
	 [Node] Finished &#34;smoothflow_it.mask&#34;.
190416-10:17:51,477 nipype.workflow INFO:
	 [Node] Setting-up &#34;smoothflow_it.mask&#34; in &#34;/dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_4/mask&#34;.
190416-10:17:51,550 nipype.workflow INFO:
	 [Node] Running &#34;mask&#34; (&#34;nipype.interfaces.fsl.maths.ApplyMask&#34;), a CommandLine Interface with command:
fslmaths /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_4/smooth/sub-01_ses-test_T1w_smooth.nii.gz -mas /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/bet_node/sub-01_ses-test_T1w_brain_mask.nii.gz /dartfs/rc/lab/P/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow_it/_fwhm_4/mask/sub-01_ses-test_T1w_smooth_masked.nii.gz
190416-10:17:54,777 nipype.workflow INFO:
	 [Node] Finished &#34;smoothflow_it.mask&#34;.
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>let's see the graph</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">res_it</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[smoothflow_it.bet_node,
 smoothflow_it.mask.a0,
 smoothflow_it.smooth.aI.a0,
 smoothflow_it.mask.a1,
 smoothflow_it.smooth.aI.a1,
 smoothflow_it.mask.a2,
 smoothflow_it.smooth.aI.a2]</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see the file structure that was created:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> tree -L <span class="m">3</span> <span class="o">{</span><span class="s1">&#39;/dartfs-hpc/rc/home/v/&#39;</span> + your_netid + <span class="s1">&#39;/Psych60/students_output/&#39;</span> + your_netid + <span class="s1">&#39;/6_nipype/output/working_dir/smoothflow/&#39;</span><span class="o">}</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>/dartfs-hpc/rc/home/v/f00275v/Psych60/students_output/f00275v/6_nipype/output/working_dir/smoothflow/
|-- bet
|   |-- _0xea357d12a50dbd994accbae278895201.json
|   |-- command.txt
|   |-- _inputs.pklz
|   |-- _node.pklz
|   |-- _report
|   |   `-- report.rst
|   |-- result_bet.pklz
|   `-- sub-01_ses-test_T1w_brain_mask.nii.gz
|-- d3.js
|-- graph1.json
|-- graph_detailed.dot
|-- graph_detailed.png
|-- graph.dot
|-- graph.json
|-- graph.png
|-- index.html
|-- mask
|   |-- _0xec44a1986ad59e4d922a84d43e4b3528.json
|   |-- command.txt
|   |-- _inputs.pklz
|   |-- _node.pklz
|   |-- _report
|   |   `-- report.rst
|   |-- result_mask.pklz
|   `-- sub-01_ses-test_T1w_smooth_masked.nii.gz
|-- smooth
|   |-- _0x7218167d46551014f0f633e94d8027fc.json
|   |-- command.txt
|   |-- _inputs.pklz
|   |-- _node.pklz
|   |-- _report
|   |   `-- report.rst
|   |-- result_smooth.pklz
|   `-- sub-01_ses-test_T1w_smooth.nii.gz
|-- workflow_graph.dot
`-- workflow_graph.png

6 directories, 31 files
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>you have now 7 nodes instead of 3!</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="MapNode">MapNode<a class="anchor-link" href="#MapNode"> </a></h3><p>If you want to iterate over a list of inputs, but need to feed all iterated outputs afterward as one input (an array) to the next node, you need to use a <strong><code>MapNode</code></strong>. A <code>MapNode</code> is quite similar to a normal <code>Node</code>, but it can take a list of inputs and operate over each input separately, ultimately returning a list of outputs.</p>
<p>Imagine that you have a list of items (let's say files) and you want to execute the same node on them (for example some smoothing or masking). Some nodes accept multiple files and do exactly the same thing on them, but some don't (they expect only one file). <code>MapNode</code> can solve this problem. Imagine you have the following workflow:</p>
<p><img src="../../images/nipype/mapnode.png" alt="file_tree"></p>
<p>Node <code>A</code> outputs a list of files, but node <code>B</code> accepts only one file. Additionally, <code>C</code> expects a list of files. What you would like is to run <code>B</code> for every file in the output of <code>A</code> and collect the results as a list and feed it to <code>C</code>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong> Let's run a simple numerical example using nipype <code>Function</code> interface </strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">square_func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span>

<span class="n">square</span> <span class="o">=</span> <span class="n">Function</span><span class="p">(</span><span class="n">input_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">output_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f_x&quot;</span><span class="p">],</span> <span class="n">function</span><span class="o">=</span><span class="n">square_func</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If I want to know the results only for one <code>x</code> we can use <code>Node</code>:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">square_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">square</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;square&quot;</span><span class="p">)</span>
<span class="n">square_node</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">square_node</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">res</span><span class="o">.</span><span class="n">outputs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>190416-10:20:32,950 nipype.workflow INFO:
	 [Node] Setting-up &#34;square&#34; in &#34;/tmp/tmpt00044pj/square&#34;.
190416-10:20:32,958 nipype.workflow INFO:
	 [Node] Running &#34;square&#34; (&#34;nipype.interfaces.utility.wrappers.Function&#34;)
190416-10:20:32,970 nipype.workflow INFO:
	 [Node] Finished &#34;square&#34;.
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>
f_x = 4</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>let's try to ask for more values of <code>x</code></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># NBVAL_SKIP</span>
<span class="n">square_node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">square</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;square&quot;</span><span class="p">)</span>
<span class="n">square_node</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">square_node</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">res</span><span class="o">.</span><span class="n">outputs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>190416-10:20:35,600 nipype.workflow INFO:
	 [Node] Setting-up &#34;square&#34; in &#34;/tmp/tmpwc7u5ql7/square&#34;.
190416-10:20:35,605 nipype.workflow INFO:
	 [Node] Running &#34;square&#34; (&#34;nipype.interfaces.utility.wrappers.Function&#34;)
190416-10:20:35,617 nipype.workflow WARNING:
	 [Node] Error on &#34;square&#34; (/tmp/tmpwc7u5ql7/square)
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-53-e3deab85d48b&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> square_node <span class="ansi-blue-fg">=</span> Node<span class="ansi-blue-fg">(</span>square<span class="ansi-blue-fg">,</span> name<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#34;square&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> square_node<span class="ansi-blue-fg">.</span>inputs<span class="ansi-blue-fg">.</span>x <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">2</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">]</span>
<span class="ansi-green-fg">----&gt; 4</span><span class="ansi-red-fg"> </span>res <span class="ansi-blue-fg">=</span> square_node<span class="ansi-blue-fg">.</span>run<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> res<span class="ansi-blue-fg">.</span>outputs

<span class="ansi-green-fg">/optnfs/el7/jupyterhub/envs/Psych60-Chang/lib/python3.7/site-packages/nipype/pipeline/engine/nodes.py</span> in <span class="ansi-cyan-fg">run</span><span class="ansi-blue-fg">(self, updatehash)</span>
<span class="ansi-green-intense-fg ansi-bold">    471</span> 
<span class="ansi-green-intense-fg ansi-bold">    472</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 473</span><span class="ansi-red-fg">             </span>result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_run_interface<span class="ansi-blue-fg">(</span>execute<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    474</span>         <span class="ansi-green-fg">except</span> Exception<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    475</span>             logger<span class="ansi-blue-fg">.</span>warning<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;[Node] Error on &#34;%s&#34; (%s)&#39;</span><span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>fullname<span class="ansi-blue-fg">,</span> outdir<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/optnfs/el7/jupyterhub/envs/Psych60-Chang/lib/python3.7/site-packages/nipype/pipeline/engine/nodes.py</span> in <span class="ansi-cyan-fg">_run_interface</span><span class="ansi-blue-fg">(self, execute, updatehash)</span>
<span class="ansi-green-intense-fg ansi-bold">    555</span>             self<span class="ansi-blue-fg">.</span>_update_hash<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    556</span>             <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_load_results<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 557</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_run_command<span class="ansi-blue-fg">(</span>execute<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    558</span> 
<span class="ansi-green-intense-fg ansi-bold">    559</span>     <span class="ansi-green-fg">def</span> _load_results<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-green-fg">/optnfs/el7/jupyterhub/envs/Psych60-Chang/lib/python3.7/site-packages/nipype/pipeline/engine/nodes.py</span> in <span class="ansi-cyan-fg">_run_command</span><span class="ansi-blue-fg">(self, execute, copyfiles)</span>
<span class="ansi-green-intense-fg ansi-bold">    635</span>         logger<span class="ansi-blue-fg">.</span>info<span class="ansi-blue-fg">(</span>message<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    636</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 637</span><span class="ansi-red-fg">             </span>result <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_interface<span class="ansi-blue-fg">.</span>run<span class="ansi-blue-fg">(</span>cwd<span class="ansi-blue-fg">=</span>outdir<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    638</span>         <span class="ansi-green-fg">except</span> Exception <span class="ansi-green-fg">as</span> msg<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    639</span>             result.runtime.stderr = &#39;%s\n\n%s&#39;.format(

<span class="ansi-green-fg">/optnfs/el7/jupyterhub/envs/Psych60-Chang/lib/python3.7/site-packages/nipype/interfaces/base/core.py</span> in <span class="ansi-cyan-fg">run</span><span class="ansi-blue-fg">(self, cwd, ignore_exception, **inputs)</span>
<span class="ansi-green-intense-fg ansi-bold">    373</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    374</span>             runtime <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_pre_run_hook<span class="ansi-blue-fg">(</span>runtime<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 375</span><span class="ansi-red-fg">             </span>runtime <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_run_interface<span class="ansi-blue-fg">(</span>runtime<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    376</span>             runtime <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>_post_run_hook<span class="ansi-blue-fg">(</span>runtime<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    377</span>             outputs <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>aggregate_outputs<span class="ansi-blue-fg">(</span>runtime<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/optnfs/el7/jupyterhub/envs/Psych60-Chang/lib/python3.7/site-packages/nipype/interfaces/utility/wrappers.py</span> in <span class="ansi-cyan-fg">_run_interface</span><span class="ansi-blue-fg">(self, runtime)</span>
<span class="ansi-green-intense-fg ansi-bold">    142</span>                 args<span class="ansi-blue-fg">[</span>name<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> value
<span class="ansi-green-intense-fg ansi-bold">    143</span> 
<span class="ansi-green-fg">--&gt; 144</span><span class="ansi-red-fg">         </span>out <span class="ansi-blue-fg">=</span> function_handle<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span>args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    145</span>         <span class="ansi-green-fg">if</span> len<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_output_names<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    146</span>             self<span class="ansi-blue-fg">.</span>_out<span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>_output_names<span class="ansi-blue-fg">[</span><span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> out

<span class="ansi-green-fg">&lt;string&gt;</span> in <span class="ansi-cyan-fg">square_func</span><span class="ansi-blue-fg">(x)</span>

<span class="ansi-red-fg">TypeError</span>: unsupported operand type(s) for ** or pow(): &#39;list&#39; and &#39;int&#39;</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>It will give an error since <code>square_func</code> do not accept list. But we can try <code>MapNode</code>:</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">square_mapnode</span> <span class="o">=</span> <span class="n">MapNode</span><span class="p">(</span><span class="n">square</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;square&quot;</span><span class="p">,</span> <span class="n">iterfield</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">])</span>
<span class="n">square_mapnode</span><span class="o">.</span><span class="n">inputs</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">square_mapnode</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="n">res</span><span class="o">.</span><span class="n">outputs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>190416-10:20:44,357 nipype.workflow INFO:
	 [Node] Setting-up &#34;square&#34; in &#34;/tmp/tmpfppfwzmm/square&#34;.
190416-10:20:44,365 nipype.workflow INFO:
	 [Node] Setting-up &#34;_square0&#34; in &#34;/tmp/tmpfppfwzmm/square/mapflow/_square0&#34;.
190416-10:20:44,370 nipype.workflow INFO:
	 [Node] Running &#34;_square0&#34; (&#34;nipype.interfaces.utility.wrappers.Function&#34;)
190416-10:20:44,377 nipype.workflow INFO:
	 [Node] Finished &#34;_square0&#34;.
190416-10:20:44,380 nipype.workflow INFO:
	 [Node] Setting-up &#34;_square1&#34; in &#34;/tmp/tmpfppfwzmm/square/mapflow/_square1&#34;.
190416-10:20:44,384 nipype.workflow INFO:
	 [Node] Running &#34;_square1&#34; (&#34;nipype.interfaces.utility.wrappers.Function&#34;)
190416-10:20:44,391 nipype.workflow INFO:
	 [Node] Finished &#34;_square1&#34;.
190416-10:20:44,396 nipype.workflow INFO:
	 [Node] Finished &#34;square&#34;.
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Bunch(f_x=[4, 16])</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Notice that <code>f_x</code> is a list again!</strong></p>

</div>
</div>
</div>
</div>

 


    </main>
    
            </div>
            <div class="c-textbook__footer" id="textbook_footer">
              
<nav class="c-page__nav">
  
    
    

    <a id="js-page__nav__prev" class="c-page__nav__prev" href="/features/markdown/Preprocessing.html">
      〈 <span class="u-margin-right-tiny"></span> Preprocessing
    </a>
  

  
    

    
    <a id="js-page__nav__next" class="c-page__nav__next" href="/features/notebooks/7_Nipype_Preprocessing.html">
      Building Preprocessing Workflows w... <span class="u-margin-right-tiny"></span> 〉
    </a>
  
</nav>

              <footer>
  <p class="footer">This page was created by <a href="http://www.lukejchang.com/">Luke Chang<a> using <a href="https://jupyterbook.org/">Jupyter Book</a></p>
</footer>

            </div>

        </div>
      </main>
    </div>
  </body>
</html>
